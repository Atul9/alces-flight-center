
<div class='card'>
  <div class='card-header'>
    <ul class="nav">
      <li class="nav-item">
        <span class="navbar-brand">
          <%= archive ? 'All' : 'Open' %>
          support cases
        </span>
      </li>
      <% unless archive %>
        <li class="nav-item">
          <%= link_to 'View all',
            cases_path,
            class: ['nav-link', 'btn', 'btn-dark'],
            role: 'button'
          %>
        </li>
      <% end %>
      <%= render 'cases/new_support_case_button' %>
    </ul>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Creator</th>
        <th>Category</th>
        <th>Issue</th>
        <th>Cluster</th>
        <th>Associated component</th>
        <th>Details</th>
        <th>Contact support</th>
        <th>Archive</th>
      </tr>
    </thead>

    <tbody>
    <% cases.reverse.each do |c| %>
      <% if archive || c.open %>
        <% if c.archived %>
          <tr
            class="archived-case-row"
            title="This support case has been archived; you must open a new support case if you wish to contact Alces Flight Support"
          >
        <% else %>
          <tr>
        <% end %>
          <td><%= c.created_at %></td>
          <td><%= c.user.name %></td>
          <td><%= c.case_category.name %></td>
          <td><%= c.issue.name %></td>
          <td><%= c.cluster.name %></td>
          <td><%= c.component&.name %></td>
          <td><%= c.details %></td>
          <td><%= render 'cases/email_support_icon', support_case: c %></td>
          <td><%= render 'cases/archive_icon', support_case: c %></td>
        </tr>
      <% end %>
    <% end %>
    </tbody>
  </table>
</div>
