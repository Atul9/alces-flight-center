<% check_groups = cluster.cluster_checks
  .group_by { |c| Check.find(c.check_id).check_category_id }
%>
<% content_for(:subtitle) { "Cluster checks" } %>
<%= render 'partials/tabs', activate: :checks do %>
  <form>
    <div class="card-body row">
      <div class="col-sm-12">
        <h3><%= cluster.name %> Checks for <%= Date.today.to_formatted_s(:short) %> 2018</h3>
        <% check_groups.each do |group| %>
          <h4><%= CheckCategory.find_by_id(group[0]).name %></h4>
          <%= render 'partials/table',
            collection: cluster.cluster_checks,
            message: 'No cluster checks to display' do %>
            <thead>
              <tr class="nowrap">
                <th>Check</th>
                <th>Command</th>
                <th>Comment</th>
                <th>Result</th>
              </tr>
            </thead>
            <tbody>
              <% group[1].each_with_index do |check, index| %>
                <% cluster_check = Check.find(check.check_id) %>
                <tr class="case-highlight">
                  <td style="width: 30%;"><%= cluster_check.name %></td>
                  <td style="width: 20%;">
                    <p style="color: #ea3ea6; font-style: italic;">
                    <%= cluster_check.command %>
                    </p>
                  </td>
                  <td style="width: 40%;">
                    <input type="text" style="width: 100%" placeholder=
                    "(Optional) Enter a comment about the check here" required>
                  </td>
                  <td class="nowrap">
                    <div class="btn-group btn-group-toggle" data-toggle="buttons">
                      <label class="btn btn-primary">
                        <input type="radio" name=<%= "#{index}-result" %>
                      id="success" autocomplete="off" required>
                        <i class="fa fa-check" style="color: #18bcb0;"></i>
                      </label>
                      <label class="btn btn-primary">
                        <input type="radio" name=<%= "#{index}-result" %>
                      id="failure" autocomplete="off">
                        <i class="fa fa-remove" style="color: red;"></i>
                      </label>
                      <label class="btn btn-primary">
                        <input type="radio" name=<%= "#{index}-result" %>
                      id="na" autocomplete="off"> N/A
                      </label>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          <% end %>
        <% end %>
      </div>
      <input type="submit" class="btn btn-primary btn-block" value="Submit Cluster Check Results">
    </div>
  </form>
<% end %>
