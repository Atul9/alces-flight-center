
<%
  user_can_confirm_maintenance = policy(window).confirm?
  confirm_disabled_class = user_can_confirm_maintenance ? '' : 'disabled'
  confirm_disabled = !user_can_confirm_maintenance
  confirm_title = if user_can_confirm_maintenance
                    nil
                  else
                    "As a #{current_user.role} you cannot confirm maintenance"
                  end
%>

<%= link_to(
  raw('Unconfirmed &mdash; click to confirm'),
  window.confirm_path,
  class: ['btn', 'btn-success', 'btn-block', confirm_disabled_class],
  disabled: confirm_disabled,
  title: confirm_title
)
%>

<% if policy(window).cancel? %>
  <%= button_to 'Cancel request for maintenance',
    cancel_maintenance_window_path(window),
    class: ['btn', 'btn-warning', 'btn-block'],
    data: {
      confirm: 'Are you sure you want to cancel this requested maintenance?'
    }
  %>
<% else %>
  <%= button_to 'Reject request for maintenance',
    reject_maintenance_window_path(window),
    class: ['btn', 'btn-danger', 'btn-block'],
    data: {
      confirm: <<~EOF.squish
        Are you sure you want to reject this requested maintenance? Alces
        Software engineers will not be able to perform this maintenance until
        you have confirmed it.
      EOF
    }
  %>
<% end %>
